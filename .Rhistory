#INDICI DI POSIZIONE
#usiamo un dataset pre fatto, ovvero iris
data("iris")
force(iris)
View(iris)
head(iris)
head(iris,5)#mostriamo le prime 5 righe del dataset
head(iris,10)#mostriamo le prime 5 righe del dataset
levels(iris$Species)#vediamo le specie
#estraimano le colonne del dataframe
attach(iris)
View(iris)
#moda
table(Species)
#andiamo ora su variabili quantitative
n = lenght(Petal.Length)
#andiamo ora su variabili quantitative
n = length(Petal.Length)
sort(Petal.Length)
Petal.Length[1]
sort(Petal.Length)
Petal.Length[1]
Petal.Length[0]
sort(Petal.Length)[1]
min(Petal.Length)
max(Petal.Length)
sort(Petal.Length)[n]#alternativa per avere il massimo
#mediana
sort(Petal.Length)[n/2]
#mediana
median(Petal.Length)
sort(Petal.Length)[75]#fatta da me
sort(Petal.Length)[c(75,76)]
#quantili
#la mediana e il secondo quaritle e lo abbiamo gia trovato
#dobbiamo trovare ora il 1 e il 3 quartile
n/4
#quartili
#la mediana e il secondo quaritle e lo abbiamo gia trovato
#dobbiamo trovare ora il 1 e il 3 quartile
sort(Petal.Length)[38]
#mentre per il 3 sara n/4 *3 che dara
n/4*3
#mentre per il 3 sara n/4 *3 che dara
(n/4)*3
#mentre per il 3 sara n/4 *3 che dara 122.5 arrotondato sara 123
sort(Petal.Length)[123]
#la funzione di R è
quantile(Petal.Length)
#mentre per il 3 sara n/4 *3 che dara 112.5 arrotondato sara 113
sort(Petal.Length)[113]
quantile(Petal.Length,c(0,1,0.1))
quantile(Petal.Length,c(0,2,0.1))
quantile(Petal.Length,c(0,150,0.1))
quantile(Petal.Length,seq(0,1,0.1))#cosi troviamo i decili
quantile(Petal.Length,seq(0,1,1))#cosi troviamo i decili
quantile(Petal.Length,seq(0,10,0.1))#cosi troviamo i decili
quantile(Petal.Length,seq(0,1,0.2))#cosi troviamo i decili
quantile(Petal.Length,seq(0,1,0.2))#cosi troviamo i quintili
quantile(Petal.Length,seq(0,1,0.01))#cosi troviamo i percentili
#media
sum(Petal.Length)/n
mean(Petal.Length)
median(Petal.Length)#funzione automatica
mean(Petal.Length)
#dimostriamo che la mediana è molto più forte
x = c(Petal.Length,541,378)
mean(x)
median(x)
#dividiamo in classi e costruiamo la ditribuzione di frequenza in classi
Petal_Length_cl = cut(Petal.Length,seq(0,7,1))
table(Petal_Length_cl)
fi = table(Petal_Length_cl)/n
fi
ni
ni = table(Petal_Length_cl)
ni
Ni = cumsum(Petal_Length_cl)
Ni = cumsum(table(Petal_Length_cl))
Fi = cumsum(table(Petal_Length_cl))/n
dist_freq = as.data.frame(cbind(ni,fi,Ni,Fi))
dist_freq
table(Petal_Length_cl)
#classe modale (classe con più elemenetni)
median(dist_freq$ni)
quantile(dist_freq$ni)
#funzione di R
quantile(Petal.Length)#trova anche min e max
dist_freq
#classe modale (classe con più elemenetni)
median(dist_freq$ni)
median(Petal.Length)#funzione automatica
mean(Petal.Length)
#la mediana
median(dist_freq$ni)
#funzione di R
quantile(Petal.Length)#trova anche min e max
dist_freq
#Media Ponderata
dist_freq$cxi = seq(0,6.5,1)#aggiungi la righa come sequenza che va da 0 a 6.5 di passo 1
dist_freq
#Media Ponderata
dist_freq$cxi = seq(0.5,6.5,1)#aggiungi la righa come sequenza che va da 0 a 6.5 di passo 1
dist_freq
sum(dist_freq$cxi*ni)/n
sum(dist_freq$cxi*dist_freq$ni)/n
weighted.mean(dist_freq$cxi,ni)
install.packages("quantmod")
library(quantmod)
incrementi = quantmod::Delt(cellule)*100
#MEDIA GEOMETRICA
cellule = c(1000,1800,2100,3000,5000)#abbiamo un esempio che mostra il numero di cellule in giorni diversi
incrementi = quantmod::Delt(cellule)*100
incrementi
#facciamo in modo che incrementi sia un vettore
incrementi = [-1,1]
#facciamo in modo che incrementi sia un vettore
incrementi = incrementi[-1,1]
incrementi
geometric_min <- function(vettore){
return(prod(vettore)^(1/length(vettore)))#radice di n del prodotto di tutti i dati
}
geometric_min(incrementi)
mean(incrementi)
#una volta finito usiamo il detach per riattacare le colonne
detach()
#la velocita media di percorrenza di queste 4 velocità (serve la media armonica)
1/speed
#MEDIA ARMONICA
speed <- c(100,80,40,90)#velocita nei vari tratti di strada e noi vogliamo
#la velocita media di percorrenza di queste 4 velocità (serve la media armonica)
1/speed
#la velocita media di percorrenza di queste 4 velocità (serve la media armonica)
1/mean(1/speed)
mean(speed)
return(1/mean(1/vettore))
return(1 / (sum(1/vettore)/length(vettore)))
return(1/(sum(1/y)/length(y)))
return(1/(sum(1/vettore)/length(vettore)))
return(1 / (sum(1/x)/length(x)) )
return(1 / (sum(1/x)/length(x)) )
return(1/(sum(1/x)/length(x)) )
armonic_mean <- function(x){
return(1/(sum(1/x)/length(x)) )
}
return(1/(sum(1/x)/length(x)) )
return(1/(sum(1/x)/length(x)))
armonic_mean <- function(x){
return(1/(sum(1/x)/length(x)))
}
armonic_mean2 <- function(x){
return(1/mean(1/x))
}
#la velocita media di percorrenza di queste 4 velocità (serve la media armonica)
1/mean(1/speed)#abbiamo dovuto scriverla perche non esiste la funzione di R
armonic_mean(speed)
armonic_mean2(speed)
install.packages("ggpubr")
library(ggthemes)
library(ggpubr)
#impostazione zona di lavoro
setwd("C:\\Users\\gabri\\Desktop\\PrivateProject\\Analisi-Statistica-Vendite-Texas")
#import dataset
texas_price <- read.csv("realestate_texas.csv")
attach(texas_price)
#Raggrupiamo per città e creiamo un mini dattaset con dati utili per i plot
time_period_ragrup=texas_price %>% #prendiamo il dataset
group_by(year,city)%>%
summarise(guadagni=sum(volume))
#Raggrupiamo per mesi e anni e succesivamente filtriamo
time_period_ragrup_month=texas_price %>% #prendiamo il dataset
group_by(year,month,city)%>%
summarise(guadagni=sum(volume))
#import librerie
library(ggplot2)
library(plotly)
library("gridExtra")
library("moments")
library(ggthemes)
library(ggpubr)
#Raggrupiamo per mesi e anni e succesivamente filtriamo
time_period_ragrup_month=texas_price %>% #prendiamo il dataset
group_by(year,month,city)%>%
summarise(guadagni=sum(volume))
#filtrimao e plottimo per i vari anni
anno2010 =filter(time_period_ragrup_month,year==2010)
ggplot() +
geom_line(data = anno2010,
aes(x = month, y = guadagni,color=city),size=1)+
labs(title="Andamento dei guadagni nei mesi del 2010 per città",
x="Mesi",
y="Guadagni")+
theme_fivethirtyeight()+
theme(axis.title = element_text())
a=ggplot() +
geom_line(data = anno2010,
aes(x = month, y = guadagni,color=city),size=1)+
labs(title="Andamento dei guadagni nei mesi del 2010 per città",
x="Mesi",
y="Guadagni")+
theme_fivethirtyeight()+
theme(axis.title = element_text())
#filtrimao e plottimo per i vari anni
anno2011 =filter(time_period_ragrup_month,year==2011)
b=ggplot() +
geom_line(data = anno2011,
aes(x = month, y = guadagni,color=city),size=1)+
labs(title="Andamento dei guadagni nei mesi del 2011 per città",
x="Mesi",
y="Guadagni")+
theme_fivethirtyeight()+
theme(axis.title = element_text())
#filtrimao e plottimo per i vari anni
anno2012 =filter(time_period_ragrup_month,year==2012)
c=ggplot() +
geom_line(data = anno2012,
aes(x = month, y = guadagni,color=city),size=1)+
labs(title="Andamento dei guadagni nei mesi del 2012 per città",
x="Mesi",
y="Guadagni")+
theme_fivethirtyeight()+
theme(axis.title = element_text())
#filtrimao e plottimo per i vari anni
anno2013 =filter(time_period_ragrup_month,year==2013)
d=ggplot() +
geom_line(data = anno2013,
aes(x = month, y = guadagni,color=city),size=1)+
labs(title="Andamento dei guadagni nei mesi del 2013 per città",
x="Mesi",
y="Guadagni")+
theme_fivethirtyeight()+
theme(axis.title = element_text())
#filtrimao e plottimo per i vari anni
anno2014 =filter(time_period_ragrup_month,year==2014)
#filtrimao e plottimo per i vari anni
anno2014 =filter(time_period_ragrup_month,year==2014)
e=ggplot() +
geom_line(data = anno2014,
aes(x = month, y = guadagni,color=city),size=1)+
labs(title="Andamento dei guadagni nei mesi del 2014 per città",
x="Mesi",
y="Guadagni")+
theme_fivethirtyeight()+
theme(axis.title = element_text())
#mergiamo tutti i grafici
figure <- ggarrange(a, b, c,d,e,
labels = c("2010", "2011", "2012","2013","2014"),
ncol = 3, nrow = 3)
figure
#Quale la città con più annunci ?
ggplot(data=texas_price, aes(x=city, y=listings,fill=city)) +
geom_bar(stat="identity",width=0.5)+
labs(title="Quale la città con più annunci ?",
x="Città",
y="Annunci")+
theme_fivethirtyeight()+
theme(axis.title = element_text(),legend.position='none')
#import dataset
texas_price <- read.csv("realestate_texas.csv")
attach(texas_price)
#In quali citta i prezzi sono più alti ?
ggplot(data=City_sales_volume_meanPrice, aes(x=city, y=Prezzo_Medio,fill=city)) +
geom_bar(stat="identity",width=0.5)+
labs(title="In quali citta i prezzi sono più alti ?",
x="Città",
y="Prezzo")+
theme_fivethirtyeight()+
theme(axis.title = element_text(),legend.position='none')
#Raggrupiamo per città e creiamo un mini dattaset con dati utili per i plot
City_sales_volume_meanPrice=texas_price %>% #prendiamo il dataset
group_by(city)%>%
summarise(Totale_Guadagni=sum(volume),
Totale_vendite=sum(sales),
Prezzo_Medio=mean(mean_price)*1000,
Annunci=sum(listings),
AnnunciMediSoddisfatti=mean(perc_satisfied_ads))
#In quali citta i prezzi sono più alti ?
ggplot(data=City_sales_volume_meanPrice, aes(x=city, y=Prezzo_Medio,fill=city)) +
geom_bar(stat="identity",width=0.5)+
labs(title="In quali citta i prezzi sono più alti ?",
x="Città",
y="Prezzo")+
theme_fivethirtyeight()+
theme(axis.title = element_text(),legend.position='none')
#In quali citta i prezzi sono più alti ?
ggplot(data=City_sales_volume_meanPrice, aes(x=city, y=Prezzo_Medio,fill=city)) +
geom_bar(stat="identity",width=0.5)+
labs(title="In quali citta i prezzi sono più alti ?",
x="Città",
y="Prezzo")+
theme_fivethirtyeight()+
theme(axis.title = element_text(),legend.position='none')
#Raggrupiamo per città e creiamo un mini dattaset con dati utili per i plot
City_sales_volume_meanPrice=texas_price %>% #prendiamo il dataset
group_by(city)%>%
summarise(Totale_Guadagni=sum(volume),
Totale_vendite=sum(sales),
Prezzo_Medio=mean(mean_price)*1000,
Annunci=sum(listings),
AnnunciMediSoddisfatti=mean(perc_satisfied_ads))
#aggiungere una colonna con il prezzo medio
#per ogni record prendo il volume di vendita e lo divido per il numero dlle vendite
#dopodiche lo moltiplico per mille per averlo sulla stessa unita di misura del prezzo mediano
texas_price$mean_price = (texas_price$volume*1000)/texas_price$sales
#Aggiungo colonna su annunci di vendità
texas_price$perc_satisfied_ads = (texas_price$sales/texas_price$listings)*100
#Raggrupiamo per città e creiamo un mini dattaset con dati utili per i plot
City_sales_volume_meanPrice=texas_price %>% #prendiamo il dataset
group_by(city)%>%
summarise(Totale_Guadagni=sum(volume),
Totale_vendite=sum(sales),
Prezzo_Medio=mean(mean_price)*1000,
Annunci=sum(listings),
AnnunciMediSoddisfatti=mean(perc_satisfied_ads))
#In quali citta i prezzi sono più alti ?
ggplot(data=City_sales_volume_meanPrice, aes(x=city, y=Prezzo_Medio,fill=city)) +
geom_bar(stat="identity",width=0.5)+
labs(title="In quali citta i prezzi sono più alti ?",
x="Città",
y="Prezzo")+
theme_fivethirtyeight()+
theme(axis.title = element_text(),legend.position='none')
#Quale stato l'anno con più vendite ?
ggplot(data=texas_price, aes(x=year, y=sales,fill=city)) +
geom_bar(stat="identity",width=0.5)+
labs(title="Quale stato l'anno con più vendite ?",
x="Anni",
y="Vendite")+
theme_fivethirtyeight()+
theme(axis.title = element_text())
#Quale stato l'anno con più vendite ? (ma normalizzato)
ggplot(data=texas_price, aes(x=year, y=sales,fill=city)) +
stat_bin(stat="identity",width=0.5)+
labs(title="Quale stato l'anno con più vendite ?",
x="Anni",
y="Vendite")+
theme_fivethirtyeight()+
theme(axis.title = element_text())
#Quale stato l'anno con più vendite ? (ma normalizzato)
ggplot(data=texas_price) +
stat_bin(aes(x=year, y=sales,fill=city),stat="identity",width=0.5)+
labs(title="Quale stato l'anno con più vendite ?",
x="Anni",
y="Vendite")+
theme_fivethirtyeight()+
theme(axis.title = element_text())
#Quale stato l'anno con più vendite ? (ma normalizzato)
ggplot(data=texas_price) +
stat_bin(aes(x=year, y=sales,fill=city))+
labs(title="Quale stato l'anno con più vendite ?",
x="Anni",
y="Vendite")+
theme_fivethirtyeight()+
theme(axis.title = element_text())
#Quale stato l'anno con più vendite ? (ma normalizzato)
ggplot(data=texas_price) +
stat_bin(aes(x=year, y=sales))+
labs(title="Quale stato l'anno con più vendite ?",
x="Anni",
y="Vendite")+
theme_fivethirtyeight()+
theme(axis.title = element_text())
#Quale stato l'anno con più vendite ? (ma normalizzato)
ggplot(data=texas_price, aes(x=year, y=sales,fill=city)) +
geom_bar(stat="identity",position = fill,width=0.5)+
labs(title="Quale stato l'anno con più vendite ?",
x="Anni",
y="Vendite")+
theme_fivethirtyeight()+
theme(axis.title = element_text())
#Quale stato l'anno con più vendite ? (ma normalizzato)
ggplot(data=texas_price, aes(x=year, y=sales,fill=city)) +
geom_bar(stat="identity",position = "fill",width=0.5)+
labs(title="Quale stato l'anno con più vendite ?",
x="Anni",
y="Vendite")+
theme_fivethirtyeight()+
theme(axis.title = element_text())
#Anno con più vendite ma con più barre
ggplot()+
geom_col(data = texas_price,aes(x=year,y=sales,fill=city),position ="dodge")+
labs(title="Quale stato l'anno con più vendite ?",
x="Anni",
y="Vendite")+
theme_fivethirtyeight()+
theme(axis.title = element_text())
#box plot per confronti
#distribuzione prezzo mediano nelle varie città
ggplot(data=texas_price)+
geom_boxplot(aes(x=city,y=median_price,fill=city))+
labs(title="Distribuzione prezzo mediano delle case nelle varie città",
x="Citta",
y="Prezzo Mediano")+
theme_fivethirtyeight()+
theme(axis.title = element_text(),legend.position='none')
#confronto distribuzioni vendite nelle città
ggplot(data=texas_price)+
geom_boxplot(aes(x=city,y=sales,fill=city))+
labs(title="Distribuzione vendite nelle varie città",
x="Citta",
y="Vendite")+
theme_fivethirtyeight()+
theme(axis.title = element_text(),legend.position='none')
