x="Anni",
y="Numero Vendite")+
theme_fivethirtyeight()+
theme(axis.title = element_text())
#In città ha avuto un fatturato più alto ?
ggplot(data=texas_price, aes(x=city, y=volume,fill=city)) +
geom_bar(stat="identity",width=0.5)+
labs(title="In città ha avuto un fatturato più alto ?",
x="Città",
y="Millioni")+
theme_fivethirtyeight()+
theme(axis.title = element_text(),legend.position='none')
#In quali citta i prezzi sono più alti ?
ggplot(data=City_sales_volume_meanPrice, aes(x=city, y=Prezzo_Medio,fill=city)) +
geom_bar(stat="identity",width=0.5)+
labs(title="In quali citta i prezzi sono più alti ?",
x="Città",
y="Prezzo")+
theme_fivethirtyeight()+
theme(axis.title = element_text(),legend.position='none')
#Quale la città con più annunci ?
ggplot(data=texas_price, aes(x=city, y=listings,fill=city)) +
geom_bar(stat="identity",width=0.5)+
labs(title="Quale la città con più annunci ?",
x="Città",
y="Millioni")+
theme_fivethirtyeight()+
theme(axis.title = element_text(),legend.position='none')
#Numero di vendita negli anni per citta
ggplot(data=texas_price, aes(x=year, y=sales,fill=city)) +
geom_bar(stat="identity",width=0.5)+
labs(title="Numero di vendita negli Anni per citta",
x="Anni",
y="Numero Vendite")+
theme_fivethirtyeight()+
theme(axis.title = element_text())
function
#-----------------divisione in classi-----------------------------------------
#dividiamo in classi le vendite per osservarne la distribuzione di frequenza
sales_cl = cut(sales,seq(50,450,50))#divisa in 7 classi da 1 centimetro l'uno
df_freq_sales = distribuzione_assoluta(sales_cl)
#-----------------divisione in classi-----------------------------------------
#dividiamo in classi le vendite per osservarne la distribuzione di frequenza
sales_cl = cut(sales,seq(50,450,50))#divisa in 7 classi da 1 centimetro l'uno
df_freq_sales = distribuzione_assoluta(sales_cl)
#INDICE DI ETEROGENEITA DI GINI
G <- function(x){
ni=table(x) #frequenze assolute
fi=ni/length(x)#frequenze relative
fi2 = fi^2 #frequenze relative al quadrato
J = length(table(x)) #tipi di classi che abbiamo
gini = 1-sum(fi2) #G=1-sommatoria di frequenze relative al quadrato
gini_norm = gini/((J-1)/J)
return(gini_norm)
}
#indice di gini per classe
G(sales_cl)
#grafico a barre
#Distribuzione in classi
ggplot(aes(x=sales_cl)) +
geom_bar(stat="identity",width=0.5)+
theme_fivethirtyeight()+
theme(axis.title = element_text())
#grafico a barre
#Distribuzione in classi
ggplot() +
geom_bar(aes(x=sales_cl),stat="identity",width=0.5)+
theme_fivethirtyeight()+
theme(axis.title = element_text())
as.data.frame(sales_cl)
#grafico a barre
#Distribuzione in classi
ggplot(as.data.frame(sales_cl),aes(x=sales_cl)) +
geom_bar(stat="identity",width=0.5)+
theme_fivethirtyeight()+
theme(axis.title = element_text())
#grafico a barre
#Distribuzione in classi
ggplot(as.data.frame(sales_cl)) +
geom_bar(aes(x=sales_cl),stat="identity",width=0.5)+
theme_fivethirtyeight()+
theme(axis.title = element_text())
#grafico a barre
#Distribuzione in classi
ggplot(as.data.frame(sales_cl)) +
geom_bar(aes(x=sales_cl),stat="identity",width=0.5)+
theme_fivethirtyeight()
rlang::last_error()
df_freq_sales = distribuzione_assoluta(sales_cl)
#DATASET DISTRIBUZIONE ASSOLUTA
distribuzione_assoluta <- function(x){
n=length(x)
ni=table(x)
fi=table(x)/n
Ni=cumsum(table(x))
Fi=cumsum(table(x))/n
return(as.data.frame(cbind(ni,fi,Ni,Fi)))
}
df_freq_sales = distribuzione_assoluta(sales_cl)
df_freq_sales
#grafico a barre
#Distribuzione in classi
ggplot(df_freq_sales) +
geom_bar(aes(x=ni,y=fi),stat="identity",width=0.5)+
theme_fivethirtyeight()
ggplot(data=df_freq_sales, aes(x=ni, y=fi)) +
geom_bar(stat="identity",width=0.5)+
theme_fivethirtyeight()+
theme(axis.title = element_text())
ggplot(data=df_freq_sales, aes(x=ni, y=fi,fill=ni)) +
geom_bar(stat="identity",width=0.5)+
labs(title="Distribuzione Vendite su 8 classi",
x="Classi",
y="Frequenza")+
theme_fivethirtyeight()+
theme(axis.title = element_text(),legend.position='none')
ggplot(data=df_freq_sales, aes(x=ni, y=fi)) +
geom_bar(stat="identity")+
labs(title="Distribuzione Vendite su 8 classi",
x="Classi",
y="Frequenza")+
theme_fivethirtyeight()+
theme(axis.title = element_text(),legend.position='none')
ggplot(data=df_freq_sales, aes(x=ni, y=fi)) +
geom_bar(stat="identity",width=0.8)+
labs(title="Distribuzione Vendite su 8 classi",
x="Classi",
y="Frequenza")+
theme_fivethirtyeight()+
theme(axis.title = element_text(),legend.position='none')
ggplot(data=df_freq_sales, aes(x=ni, y=fi)) +
geom_bar(stat="identity",width=0.50)+
labs(title="Distribuzione Vendite su 8 classi",
x="Classi",
y="Frequenza")+
theme_fivethirtyeight()+
theme(axis.title = element_text(),legend.position='none')
ggplot(data=df_freq_sales, aes(x=ni, y=fi)) +
geom_bar(stat="identity",width=0.5)+
labs(title="Distribuzione Vendite su 8 classi",
x="Classi",
y="Frequenza")+
theme_fivethirtyeight()+
theme(axis.title = element_text(),legend.position='none')
ggplot(data=df_freq_sales, aes(x=ni, y=fi)) +
geom_bar(stat="identity",width=0.9)+
labs(title="Distribuzione Vendite su 8 classi",
x="Classi",
y="Frequenza")+
theme_fivethirtyeight()+
theme(axis.title = element_text(),legend.position='none')
ggplot(data=df_freq_sales, aes(x=ni, y=fi)) +
geom_bar(stat="identity",width=1)+
labs(title="Distribuzione Vendite su 8 classi",
x="Classi",
y="Frequenza")+
theme_fivethirtyeight()+
theme(axis.title = element_text(),legend.position='none')
ggplot(data=df_freq_sales, aes(x=ni, y=fi)) +
geom_bar(stat="identity",width=3)+
labs(title="Distribuzione Vendite su 8 classi",
x="Classi",
y="Frequenza")+
theme_fivethirtyeight()+
theme(axis.title = element_text(),legend.position='none')
ggplot(data=df_freq_sales, aes(x=ni, y=fi)) +
geom_bar(stat="identity",width=2)+
labs(title="Distribuzione Vendite su 8 classi",
x="Classi",
y="Frequenza")+
theme_fivethirtyeight()+
theme(axis.title = element_text(),legend.position='none')
ggplot(data=df_freq_sales, aes(x=ni, y=fi)) +
geom_bar(stat="identity",width=1)+
labs(title="Distribuzione Vendite su 8 classi",
x="Classi",
y="Frequenza")+
theme_fivethirtyeight()+
theme(axis.title = element_text(),legend.position='none')
View(df_freq_sales)
ggplot(data=df_freq_sales, aes(x=ni, y=fi,fill=index)) +
geom_bar(stat="identity",width=1)+
labs(title="Distribuzione Vendite su 8 classi",
x="Classi",
y="Frequenza")+
theme_fivethirtyeight()+
theme(axis.title = element_text(),legend.position='none')
df_freq_sales
df_freq_sales[index]
ggplot(data=df_freq_sales, aes(x=ni, y=fi)) +
geom_bar(stat="identity",width=1)+
labs(title="Distribuzione Vendite su 8 classi",
x="Classi",
y="Frequenza")+
theme_fivethirtyeight()+
theme(axis.title = element_text())
df_freq_sales$ni,
barplot(df_freq_sales$ni)
barplot(df_freq_sales$ni,
main = "distribuzione nelle classi di lunghezza dei denti dei maiali",
xlab = "classi di lunghezza in centimetri",
ylab = "frequenze assolute",
ylim = c(0,30),#diamo un limite all'asse delle y
col = "blue",
names.arg = row.names(distr_freq_len_cl)
)
barplot(df_freq_sales,
main = "distribuzione nelle classi di lunghezza dei denti dei maiali",
xlab = "classi di lunghezza in centimetri",
ylab = "frequenze assolute",
ylim = c(0,30),#diamo un limite all'asse delle y
col = "blue",
names.arg = row.names(distr_freq_len_cl)
)
ggplot(data=df_freq_sales, aes(x=ni, y=ni)) +
geom_bar(stat="identity",width=1)+
labs(title="Distribuzione Vendite su 8 classi",
x="Classi",
y="Frequenza")+
theme_fivethirtyeight()+
theme(axis.title = element_text())
fi
ggplot(data=df_freq_sales, aes(x=ni, y=fi)) +
geom_bar(stat="identity",width=1)+
labs(title="Distribuzione Vendite su 8 classi",
x="Classi",
y="Frequenza")+
theme_fivethirtyeight()+
theme(axis.title = element_text())
barplot(df_freq_sales$ni,
main = "distribuzione nelle classi di lunghezza dei denti dei maiali",
xlab = "classi di lunghezza in centimetri",
ylab = "frequenze assolute",
ylim = c(0,30),#diamo un limite all'asse delle y
col = "blue",
names.arg = row.names(distr_freq_len_cl)
)
barplot(df_freq_sales$ni,
main = "distribuzione nelle classi di lunghezza dei denti dei maiali",
xlab = "classi di lunghezza in centimetri",
ylab = "frequenze assolute",
ylim = c(0,30),#diamo un limite all'asse delle y
col = "blue",
names.arg = row.names(distr_freq_len_cl)
)
barplot(df_freq_sales$ni,
main = "distribuzione nelle classi di lunghezza dei denti dei maiali",
xlab = "classi di lunghezza in centimetri",
ylab = "frequenze assolute",
ylim = c(0,30),#diamo un limite all'asse delle y
col = "blue",
names.arg = row.names(distr_freq_len_cl)
)
f_freq_sales$ni,
barplot(df_freq_sales$ni,
main = "distribuzione nelle classi di lunghezza dei denti dei maiali",
xlab = "classi di lunghezza in centimetri",
ylab = "frequenze assolute",
ylim = c(0,30),#diamo un limite all'asse delle y
col = "blue",
names.arg = row.names(df_freq_sales)
)
barplot(df_freq_sales$ni,
main = "distribuzione nelle classi di vendit'",
xlab = "classi di lunghezza in centimetri",
ylab = "frequenze assolute",
ylim = c(0,80),#diamo un limite all'asse delle y
col = "lightblue",
names.arg = row.names(df_freq_sales)
)
ggplot(df_freq_sales, aes(ni)) +
geom_bar(fill = "#0073C2FF") +
theme_pubclean()
ggplot(df_freq_sales, aes(ni)) +
geom_bar(fill = "#0073C2FF") +
theme_fivethirtyeight()
ggplot(df_freq_sales, aes(ni)) +
geom_bar(fill = "#0073C2FF") +
theme_fivethirtyeight()
ggplot(df_freq_sales, aes(ni, fi)) +
geom_linerange(
aes(x = ni, ymin = 0, ymax = 80),
color = "lightgray", size = 1.5
)+
geom_point(aes(color = cut), size = 2)+
ggpubr::color_palette("jco")+
theme_pubclean()
ggplot(df_freq_sales, aes(ni, fi)) +
geom_linerange(
aes(x = ni, ymin = 0, ymax = 80),
color = "lightgray", size = 1.5
)+
geom_point(aes(color = cut), size = 2)
ggplot(df_freq_sales, aes(ni, fi)) +
geom_linerange(
aes(x = ni, ymin = 0, ymax = 80),
color = "lightgray", size = 1.5
)
ggplot(df_freq_sales, aes(ni, fi)) +
geom_linerange(
aes(x = ni, ymin = 0, ymax = 80),
color = "lightblue", size = 1.5
)
ggplot(df_freq_sales, aes(ni)) +
geom_bar(fill = "#0073C2FF") +
theme_fivethirtyeight()
barplot(df_freq_sales$ni,
main = "distribuzione nelle classi di vendit'",
xlab = "classi di lunghezza in centimetri",
ylab = "frequenze assolute",
ylim = c(0,80),#diamo un limite all'asse delle y
col = "lightblue",
names.arg = row.names(df_freq_sales)
)
ggplot(data=df_freq_sales, aes(x=ni, y=fi)) +
geom_bar(stat="identity",width=1)+
labs(title="Distribuzione Vendite su 8 classi",
x="Classi",
y="Frequenza")+
theme_fivethirtyeight()+
theme(axis.title = element_text())
barplot(df_freq_sales$ni,
main = "distribuzione nelle classi di vendit'",
xlab = "classi di lunghezza in centimetri",
ylab = "frequenze assolute",
ylim = c(0,80),#diamo un limite all'asse delle y
col = "lightblue",
names.arg = row.names(df_freq_sales)
)
ggplot(data=df_freq_sales, aes(x=ni, y=fi)) +
geom_bar(stat="identity",width=1)+
labs(title="Distribuzione Vendite su 8 classi",
x="Classi",
y="Frequenza")+
theme_fivethirtyeight()+
theme(axis.title = element_text())
ggplot(data=df_freq_sales, aes(x=ni, y=fi)) +
geom_bar(stat="identity", width=0.5)
ggplot(data=df_freq_sales, aes(x=ni, y=fi)) +
geom_bar(stat="identity",width=1)+
labs(title="Distribuzione Vendite su 8 classi",
x="Classi",
y="Frequenza")+
theme_fivethirtyeight()+
theme(axis.title = element_text())
ggplot(data=df_freq_sales, aes(x=ni, y=fi,fill=row.names(df_freq_sales))) +
geom_bar(stat="identity",width=1)+
labs(title="Distribuzione Vendite su 8 classi",
x="Classi",
y="Frequenza")+
theme_fivethirtyeight()+
theme(axis.title = element_text())
ggplot(data=df_freq_sales, aes(x=ni, y=fi,fill=df_freq_sales)) +
geom_bar(stat="identity",width=1)+
labs(title="Distribuzione Vendite su 8 classi",
x="Classi",
y="Frequenza")+
theme_fivethirtyeight()+
theme(axis.title = element_text())
ggplot(data=df_freq_sales, aes(x=ni, y=fi,fill=row.names(df_freq_sales))) +
geom_bar(stat="identity",width=1)+
labs(title="Distribuzione Vendite su 8 classi",
x="Classi",
y="Frequenza")+
theme_fivethirtyeight()+
theme(axis.title = element_text())
ggplot(data=df_freq_sales, aes(x=ni, y=fi,fill=row.names(df_freq_sales))) +
geom_bar(stat="identity",width=1)+
labs(title="Distribuzione Vendite su 8 classi",
x="Classi",
y="Frequenza")+
theme_fivethirtyeight()+
theme(axis.title = element_text())+
guides(fill=guide_legend(title="Class"))
#grafico a barre
#Distribuzione in classi
ggplot(df_freq_sales) +
geom_bar(aes(x=ni,y=fi),stat="identity",width=0.5)+
theme_fivethirtyeight()
#grafico a barre
#Distribuzione in classi
ggplot(data=df_freq_sales, aes(x=ni, y=fi,fill=row.names(df_freq_sales))) +
geom_bar(stat="identity",width=1)+
labs(title="Distribuzione Vendite su 8 classi",
x="Classi",
y="Frequenza")+
theme_fivethirtyeight()+
theme(axis.title = element_text())+
guides(fill=guide_legend(title="Class"))
#grafico a barre
#Distribuzione in classi
ggplot(data=df_freq_sales, aes(x=ni, y=fi,fill=row.names(df_freq_sales))) +
geom_bar(stat="identity")+
labs(title="Distribuzione Vendite su 8 classi",
x="Classi",
y="Frequenza")+
theme_fivethirtyeight()+
theme(axis.title = element_text())+
guides(fill=guide_legend(title="Class"))
sales_cl = cut(sales,seq(50,450,100))#divisa in 7 classi da 1 centimetro l'uno
df_freq_sales2 = distribuzione_assoluta(sales_cl)
df_freq_sales2
G(sales_cl)
ggplot(data=df_freq_sales2, aes(x=ni, y=fi,fill=row.names(df_freq_sales2))) +
geom_bar(stat="identity")+
labs(title="Distribuzione Vendite su 4 classi",
x="Classi",
y="Frequenza")+
theme_fivethirtyeight()+
theme(axis.title = element_text())+
guides(fill=guide_legend(title="Class"))
#-----------------divisione in classi-----------------------------------------
#dividiamo in classi le vendite per osservarne la distribuzione di frequenza
sales_cl = cut(sales,seq(50,450,50))#divisa in 7 classi da 1 centimetro l'uno
#indice di gini per classe
G(sales_cl)
#-----------------divisione in classi-----------------------------------------
#dividiamo in classi le vendite per osservarne la distribuzione di frequenza
sales_cl = cut(sales,seq(50,450,50))#divisa in 7 classi da 1 centimetro l'uno
#indice di gini per classe
G(sales_cl)
sales_cl = cut(sales,seq(50,450,100))#divisa in 7 classi da 1 centimetro l'uno
G(sales_cl)
ggplot()+
geom_density(aes(x=sales),col="darkblue",fill="lightblue")+
geom_vline(aes(xintercept=mean(sales)),
color="red", linetype="dashed", size=1)+
geom_vline(aes(xintercept=quantile(sales,seq(0,1,0.25))),
color="green3", linetype="dashed", size=1)+
geom_vline(aes(xintercept=median(sales)),
color="orange", linetype="dashed", size=1)+
geom_vline(aes(xintercept=Mode(sales)),
color="yellow", linetype="dashed", size=1)+
xlab("Sales")+
ylab("Density")+
labs(title = "Distribuzione Sales")+
theme_fivethirtyeight()
city.Comment
#In quale città ho venduto di più ?
ggplot(data=texas_price, aes(x=city, y=sales,fill=city)) +
geom_bar(stat="identity",width=0.5)+
labs(title="Quale Città ha venduto più Case ?",
x="Citta",
y="Numero Vendite")+
theme_fivethirtyeight()+
theme(axis.title = element_text(),legend.position='none')
#In città ha avuto un fatturato più alto ?
ggplot(data=texas_price, aes(x=city, y=volume,fill=city)) +
geom_bar(stat="identity",width=0.5)+
labs(title="In che città c'è stato più guadagno ?",
x="Città",
y="Millioni")+
theme_fivethirtyeight()+
theme(axis.title = element_text(),legend.position='none')
#Quale la città con più annunci ?
ggplot(data=texas_price, aes(x=city, y=listings,fill=city)) +
geom_bar(stat="identity",width=0.5)+
labs(title="Quale la città con più annunci ?",
x="Città",
y="Millioni")+
theme_fivethirtyeight()+
theme(axis.title = element_text(),legend.position='none')
#Quale la città con più annunci ?
ggplot(data=texas_price, aes(x=city, y=listings,fill=city)) +
geom_bar(stat="identity",width=0.5)+
labs(title="Quale la città con più annunci ?",
x="Città",
y="Annunci")+
theme_fivethirtyeight()+
theme(axis.title = element_text(),legend.position='none')
#In quali citta i prezzi sono più alti ?
ggplot(data=City_sales_volume_meanPrice, aes(x=city, y=Prezzo_Medio,fill=city)) +
geom_bar(stat="identity",width=0.5)+
labs(title="In quali citta i prezzi sono più alti ?",
x="Città",
y="Prezzo")+
theme_fivethirtyeight()+
theme(axis.title = element_text(),legend.position='none')
#Quale stato l'anno con più vendite ?
ggplot(data=texas_price, aes(x=year, y=sales,fill=city)) +
geom_bar(stat="identity",width=0.5)+
labs(title="#Quale stato l'anno con più vendite ?",
x="Anni",
y="Numero Vendite")+
theme_fivethirtyeight()+
theme(axis.title = element_text())
#Quale stato l'anno con più vendite ?
ggplot(data=texas_price, aes(x=year, y=sales,fill=city)) +
geom_bar(stat="identity",width=0.5)+
labs(title="Quale stato l'anno con più vendite ?",
x="Anni",
y="Numero Vendite")+
theme_fivethirtyeight()+
theme(axis.title = element_text())
#Quale stato l'anno con più vendite ?
ggplot(data=texas_price, aes(x=year, y=sales,fill=city)) +
geom_bar(stat="identity",width=0.5)+
labs(title="Quale stato l'anno con più vendite ?",
x="Anni",
y="Vendite")+
theme_fivethirtyeight()+
theme(axis.title = element_text())
table(city)
60/240
#distribuzione di frequenza doppia Anno,Mese (per Probabilità)
distr_freq_ass_anno_mese = table(year,month)
distr_freq_ass_anno_mese
distr_freq_ass_city_anno = table(year,month)/length(month)
distr_freq_rel_anno_mese = table(year,month)/length(month)
distr_freq_rel_anno_mese
table(year,month)/length(month)
table(year,month)/length(year)
